<!-- themes/lens/layout/_partial/post-grid.ejs -->
<div class="post-grid">
  <% if (posts && posts.length > 0) { %>
    <% posts.forEach(function(post){ %>
      <% 
        // 图片逻辑
        var coverImg = theme.default_cover;
        if (post.index_img) {
          coverImg = post.index_img;
        } else if (post.photos && post.photos.length > 0) {
          coverImg = post.photos[0];
        }
      %>
      <article class="grid-card">
        <a href="<%- url_for(post.path) %>" class="card-image-link">
          <div class="card-image" style="background-image: url('<%- url_for(coverImg) %>')"></div>
        </a>
        <div class="card-content">
          <h3><a href="<%- url_for(post.path) %>"><%= post.title %></a></h3>
          <div class="card-meta"><%= date(post.date, 'MMM DD, YYYY') %></div>
          
          <p class="card-excerpt">
            <% if (post.excerpt) { %>
              <!-- 如果有摘要，去除HTML标签后显示 (保持版面整洁) -->
              <%- strip_html(post.excerpt) %>
            <% } else { %>
              <!-- 如果没有摘要，自动截取正文前100字 -->
              <%- strip_html(post.content).substring(0, 100) %>...
            <% } %>
          </p>
          
        </div>
      </article>
    <% }) %>
  <% } %>
</div>